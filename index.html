<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EMI Risk Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>

  <body class="bg-gray-100">
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect } = React;

      const getUsers = () => JSON.parse(localStorage.getItem("users") || "{}");
      const saveUsers = (u) => localStorage.setItem("users", JSON.stringify(u));
      const getLogged = () => localStorage.getItem("logged");
      const setLogged = (u) =>
        u ? localStorage.setItem("logged", u) : localStorage.removeItem("logged");

      const mask = (a) => (a ? "****" + a.slice(-4) : "â€”");

      function App() {
        const [user, setUser] = useState(null);
        const [isSignup, setIsSignup] = useState(false);
        const [form, setForm] = useState({
          username: "",
          password: "",
          confirm: "",
          name: "",
          email: "",
          phone: "",
          bank: "",
          acc: "",
        });
        const [tab, setTab] = useState("home");

        // Load user if already logged in
        useEffect(() => {
          const logged = getLogged();
          if (logged) {
            const users = getUsers();
            if (users[logged]) setUser({ username: logged, ...users[logged] });
          }
        }, []);

        const login = () => {
          const { username, password } = form;
          const users = getUsers();
          if (!users[username]) return alert("User not found");
          if (users[username].password !== password)
            return alert("Incorrect password");
          setUser({ username, ...users[username] });
          setLogged(username);
        };

        const signup = () => {
          const { username, password, confirm, name, email } = form;
          if (!username || !password || !confirm || !name || !email)
            return alert("Fill all fields");
          if (password !== confirm) return alert("Passwords don't match");
          const users = getUsers();
          if (users[username]) return alert("User exists");
          users[username] = {
            password,
            name,
            email,
            phone: form.phone,
            bank: form.bank,
            acc: form.acc,
            emis: [],
          };
          saveUsers(users);
          setUser({ username, ...users[username] });
          setLogged(username);
        };

        const logout = () => {
          setUser(null);
          setLogged(null);
        };

        const addEmi = (income, emi, sDate, dDate) => {
          const ratio = emi / income;
          let risk = "Low";
          if (ratio > 0.5) risk = "High";
          else if (ratio > 0.3) risk = "Medium";

          const users = getUsers();
          const u = users[user.username];
          u.emis.unshift({
            id: Date.now(),
            income,
            emi,
            sDate,
            dDate,
            risk,
            paid: false,
          });
          users[user.username] = u;
          saveUsers(users);
          setUser({ username: user.username, ...u });
        };

        if (!user) {
          return (
            <div className="flex items-center justify-center min-h-screen bg-gradient-to-r from-purple-500 to-pink-500 p-6">
              <div className="bg-white rounded-2xl p-8 shadow-lg w-full max-w-md">
                <h1 className="text-2xl font-bold text-center mb-4">
                  {isSignup ? "Sign Up" : "Login"}
                </h1>

                <div className="space-y-3">
                  <input
                    placeholder="Username"
                    className="border w-full p-2 rounded"
                    val
